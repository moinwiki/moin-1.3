MoinMoin Installation Instructions
==================================

Copyright (c) 2000 by Jürgen Hermann <jh@web.de>
All rights reserved, see COPYING for details.

$Id: INSTALL,v 1.13 2000/12/06 19:21:16 jhermann Exp $


##################
# GENERAL POINTS #
##################

If you want to use MoinMoin with a character set other than Latin-1, you
might or even have to change the default character sets for WikiNames in
"moin_config.py". A safe default is US-ASCII, i.e.

    upperletters = "A-Z"
    lowerletters = "0-9a-z"

With that setting, you need to set "allow_extended_names=1" and use the
special markup for extended WikiNames ["extended name"] to get any names
with characters outside the core latin alphabet.


###########################
# INSTALLATION ON WINDOWS #
###########################

The following description applies to a setup using Windows/NT4, Apache 1.3.9
and Python 1.5.2; you mileage may vary. MoinMoin is also tested with Apache
1.3.12. Starting with release 0.3, the development happens using Python 2.0,
and support for Python 1.5.2 will be kept up for a while.

We will setup the Wiki that comes with the distribution here; you should
first try to get it to run unmodified (apart from configuration changes),
and only when it works create your Wiki in its own directory.

We assume that Apache is installed to "C:\Apache" (with the subdirs "conf",
"cgi-bin", and "htdocs") and that you unpacked the MoinMoin distribution to
"C:\MoinMoin" (i.e. the directory where this file is located). If your paths
are different, please apply the necessary changes below. Note that the
directory "MoinMoin" is a package that has to be in your PYTHONPATH, i.e.
you might either want to unpack it into "C:\Python\MoinMoin", or add
"C:\" to your PYTHONPATH environment variable. If you change PYTHONPATH,
don't forget to restart your server. The "test.cgi" script can be used
to debug your setup in case of problems.

The first step is to create a cgi-bin batch file that refers to the Wiki,
so that it can be installed elsewhere. For this, we create the batch file
"C:\Apache\cgi-bin\moin.bat" with the following content:

    @echo off
    C:
    cd \MoinMoin\wiki-moinmoin
    python moin.cgi

The next step is to edit the file "C:\MoinMoin\wiki-moinmoin\moin_config.py"
and adapt it to your particular setup. The only things we need to change to
get things working are the values of the two variables "data_dir" and
"url_prefix". For our situation, we need the following values:

    data_dir = './data'
    url_prefix = '/wiki-moinmoin'

Incidently, those are the defaults. There is one last thing left to do, and
that is to add this line to "httpd.conf":

    Alias /wiki-moinmoin/ "C:/MoinMoin/wiki-moinmoin/"

This enables Apache to find image and CSS files. In order to activate that
change, restart your server.

After that, it's time to test our Wiki at the URL (possibly replacing
127.0.0.1 with your server's domain name)

    http://127.0.0.1/cgi-bin/moin.bat

You should now look at the "FrontPage" of the MoinMoin Wiki. Rejoice! To
further test your new Wiki, "EditText" the "FrontPage", save it and click
on "RecentChanges". If your edit action shows there, you have a fully
functional Wiki.


DIFF FEATURE
------------

For the "diff" button to work, you need a diff utility available on your
path, for example by installing the cygwin package available from
http://sources.redhat.com/cygwin/download.html

It also helps to have the Python Win32 Extensions installed, available from
http://www.python.org/download/download_windows.html

Finally, the directory "data/backup" has to exist, otherwise no backup
copies of your pages are stored.


VARIATIONS ON THE ABOVE
-----------------------

Instead of adding an alias to "httpd.conf", you can also copy the files
"PythonPowered.gif", "default.css", "moinmoin.gif" and "img/*" (i.e. the
whole "img" directory) to a newly created "<htdocs>/wiki-moinmoin"
directory (with "<htdocs>" referring to your global document directory).
Doing so, you do not allow access to the "data" directory (but the data
in there is public anyway).


REDUCING OR UPGRADING THE SET OF STANDARD PAGES
-----------------------------------------------

MoinMoin is released with the full set of pages found on
http://www.encrypted.net/~jh/moinmoin/moin.cgi

To reduce that set of pages to the absolute limit, consult the SystemPages
page, which lists those pages that should remain in a functional MoinMoin
system.

If you upgrade from an earlier release, you can also consult that list to
look for new SystemPages that you might want to add to your existing wiki.
Starting with release 0.4, you'll want to copy the help pages
(data/text/Help*) to your installed wiki.



########################
# INSTALLATION ON UNIX #
########################

Similar... :)

[Please read the windows section too, since it contains information also
applicable to Unix.]

We will setup the Wiki that comes with the distribution here; you should
first try to get it to run unmodified (apart from configuration changes),
and only when it works create your Wiki in its own directory.

Quick description:
    cd
    cd public_html
    tar zxvf MoinMoin-0.7.tgz
    mv MoinMoin-0.7 MoinMoin
    chmod -R a+rwX MoinMoin # might need other rights at your site!

Then edit "moin_config.py", namely:

    url_prefix = '/~YOUR-USERNAME/MoinMoin/wiki-moinmoin'

Beginning with revision 1.81, the package "MoinMoin", that is the directory
you unpacked above, must be in the PYTHONPATH. Since often, as a normal
user, you cannot change the environment in the context of the web server,
the way to extend the path is to change "moin.cgi" to look like this:

    import sys
    sys.path.append('/usr/local/home/USERNAME/public_html')
    from MoinMoin import cgimain
    cgimain.run()

Note that, for your convenience, the distributed "moin.cgi" already
contains the first two lines. Just uncomment them and adjust the path
on the second line to the directory you unpacked "MoinMoin" in.

Next, test your installation with the test CGI by using the URL

    http://127.0.0.1/~YOUR-USERNAME/MoinMoin/wiki-moinmoin/test.cgi

If the import test fails, and you have no access to the "httpd.conf", try
adding these lines to "test.cgi" and "moin.cgi" before the import command:

    import sys
    sys.path.append('/usr/local/home/YOUR-USERNAME/public_html')

Finally, give the real thing a try with the URL

    http://127.0.0.1/~YOUR-USERNAME/MoinMoin/wiki-moinmoin/moin.cgi

For the above to work, the extension ".cgi" must be activated so that it
starts the CGI script handler (ask you webmaster). If you are the webmaster,
you can do all of this directly in your "htdocs", and you have to adapt
the URL accordingly (no ~username).

Remember that a cgi script needs the "x" bit set ("chmod a+x moin.cgi") and
that the directory where it is located needs the ExecCGI option activated
in the "httpd.conf" or a ".htaccess" file. Also, the data directory and the
files in it need to be writable for you httpd server process, which usually
runs under another user account than yours, often as "nobody.nogroup"!

After you got it to run like described above, try to create a more sane
installation, e.g. like this:

    spam:~> ls -l lib/python
    total 1
    drwxr-xr-x  5 jh  lusers  512 Nov  2 19:50 MoinMoin

    spam:~> ls -l public_html/moinmoin
    lrwxr-xr-x  1 jh  lusers  53 Nov  2 18:15 public_html/moinmoin ->
        /usr/local/home/jh/lib/python/MoinMoin/wiki-moinmoin/

That means that "MoinMoin" is in your "~/lib/python" directory, and you
link from the "public_html" area to the CGI scripts. Of course, you can
also COPY the "wiki-moinmoin" directory to an appropriate place in the
"public_html" directory.

Have fun!

