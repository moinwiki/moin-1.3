##language:en
== installing MoinMoin on OS X ==
An install report of a succesfull install on a powermac G4 running mac OS X 10.2.6.
In the examples you will see that the machine name is `pm142` and the administrator account is `giels`. The wiki site that is created is called `mgwiki`.

=== before you begin ===

 * You should have activated the `root` user
 * You must not be afraid to use the terminal ;)
 * some practice with the pico editor might be useful as well

=== download ===

Download the source on the desktop: you should see a `moin-x.x.tar.gz` file. 
Extract this file on the desktop with Stuffit. You will get a folder `moin-x.x`. 

=== install ===

All code examples are taken form a terminal session.

First check everything:
{{{
[pm142:~] giels% su root
Password:
[pm142:/Users/giels] giels# whoami
root
[pm142:/Users/giels] giels# python -c 'import sys; print sys.prefix'
/usr
[pm142:/Users/giels] giels# 
[pm142:/Users/giels] giels# cd Desktop/moin-1.0
[pm142:giels/Desktop/moin-1.0] giels# ls -al
total 264
drwxr-xr-x  15 giels  staff    510 May 10  2002 .
drwxr-xr-x   9 giels  staff    306 May 12 19:39 ..
-rw-r--r--   1 giels  staff  19118 May 10  2002 CHANGES
-rw-r--r--   1 giels  staff  17992 Jun  9  2001 COPYING
-rw-r--r--   1 giels  staff  42827 May  9  2002 INSTALL.html
-rw-r--r--   1 giels  staff    837 Feb 27  2002 MANIFEST.in
drwxr-xr-x  37 giels  staff   1258 May 10  2002 MoinMoin
-rw-r--r--   1 giels  staff    553 May 10  2002 PKG-INFO
-rw-r--r--   1 giels  staff   5831 Apr 17  2002 README
-rw-r--r--   1 giels  staff    908 Jan 16  2002 TODO
drwxr-xr-x   5 giels  staff    170 May 10  2002 contributions
-rw-r--r--   1 giels  staff  13878 Jul  5  2001 moinlogo.bmp
-rw-r--r--   1 giels  staff    229 Jul  5  2001 setup.cfg
-rw-r--r--   1 giels  staff   6586 May  9  2002 setup.py
drwxr-xr-x   5 giels  staff    170 May 10  2002 wiki
[pm142:giels/Desktop/moin-1.0] giels#
}}}
the real install: 
{{{
[pm142:giels/Desktop/moin-1.0] giels# python setup.py install --record=install.log 
running install
running build
running build_py
creating build
....
creating /usr/share/moin/htdocs/applets
creating /usr/share/moin/htdocs/applets/TWikiDrawPlugin
writing list of installed files to 'install.log'
}}}
Now installation is finished. You will find a file `install.log` on the desktop in the folder `moin-x.x`.

=== configuration ===
First make a copy of the original MoinMoin site:
{{{
[pm142:giels/Desktop/moin-1.0] giels# 
[pm142:giels/Desktop/moin-1.0] giels# egrep "^User|^Group" /etc/httpd/httpd.conf
User www
Group www
[pm142:giels/Desktop/moin-1.0] giels# cd /usr/share/moin/
[pm142:/usr/share/moin] giels# ls -al
total 0
drwxr-xr-x   5 root  wheel   170 May 12 19:49 .
drwxr-xr-x  44 root  wheel  1496 May 12 19:49 ..
drwxr-xr-x   4 root  wheel   136 May 12 19:49 cgi-bin
drwxr-xr-x   9 root  wheel   306 May 12 19:49 data
drwxr-xr-x   6 root  wheel   204 May 12 19:49 htdocs
[pm142:/usr/share/moin] giels# 
[pm142:/usr/share/moin] giels# mkdir mgwiki
[pm142:/usr/share/moin] giels# cp -r data mgwiki
[pm142:/usr/share/moin] giels# cp cgi-bin/* mgwiki
[pm142:/usr/share/moin] giels# chown -R www.www mgwiki
[pm142:/usr/share/moin] giels# chmod a+rx mgwiki/*.cgi
[pm142:/usr/share/moin] giels# 
}}}
Configure Apache. We'll use the pico editor:
{{{
[pm142:/usr/share/moin] giels# pico /etc/httpd/httpd.conf
}}}
Scroll to the end of the file and edit like the example below, (only the last two lines are added; use control-x to save the file):
{{{
RegisterDefaultSite
</IfModule>

Include /private/etc/httpd/users

Alias /wiki/ "/usr/share/moin/htdocs/"      
ScriptAlias /mgwiki "/usr/share/moin/mgwiki/moin.cgi"       


^G Get Help   ^O WriteOut   ^R Read File  ^Y Prev Pg    ^K Cut Text   ^C Cur Pos    
^X Exit       ^J Justify    ^W Where is   ^V Next Pg    ^U UnCut Text ^T To Spell   
}}}

Restart Apache:
{{{
[pm142:/etc] giels# apachectl help
usage: /usr/sbin/apachectl (start|stop|restart|fullstatus|status|graceful|configtest|help)

start      - start httpd
stop       - stop httpd
restart    - restart httpd if running by sending a SIGHUP or start if 
             not running
fullstatus - dump a full status screen; requires lynx and mod_status enabled
status     - dump a short status screen; requires lynx and mod_status enabled
graceful   - do a graceful restart by sending a SIGUSR1 or start if not running
configtest - do a configuration syntax test
help       - this screen

[pm142:/etc] giels# 
[pm142:/etc] giels# apachectl graceful
/usr/sbin/apachectl graceful: httpd gracefully restarted
[pm142:/etc] giels# 
}}}

=== testing ===

In a web-browser surf to the site: `pm142/mgwiki`



== Comments ==

Here are a couple of issues with my Mac OS X install I needed to fix:

 1. The TWiki drawing jar file is not installed, so drawings do not work.  You have to find the twikidraw.jar file (download the latest stable MoinMoin tar.gz file and uncompress like: `tar xzvf moinmoin.tar.gz`), and copy the twikidraw.jar file (under `htdocs/applets/TWikiDrawPlugin`) to this folder `/usr/share/moin/htdocs/applets/TWikiDrawPlugin/`. You'll probably need to use sudo: [[BR]]`sudo cp twikidraw.jar /usr/share/moin/htdocs/applets/TWikiDrawPlugin/`[[BR]] and set permissions:[[BR]]`sudo chmod 755 /usr/share/moin/htdocs/applets/TWikiDrawPlugin/twikidraw.jar`

 1. The RSS feed for your RecentChanges page may be broken.  You need to install the most recent version of [http://sourceforge.net/projects/pyxml/ PyXML].  Here's how I did so and the RSS feed was fixed.[[BR]]`curl -O http://aleron.dl.sourceforge.net/sourceforge/pyxml/PyXML-0.8.3.tar.gz`[[BR]]`tar xzvf PyXML-0.8.3.tar.gz`[[BR]]`cd PyXML-0.8.3`[[BR]]`sudo python setup.py --without-xpath build`[[BR]]`sudo python setup.py install`

OS X users with a fink install need to chance the path `/usr/share/moin` to `/sw/share/moin`. see `install.log`.
