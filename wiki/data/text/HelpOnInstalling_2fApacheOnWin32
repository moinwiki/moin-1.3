'''Index'''
[[TableOfContents]]

== Requirements ==

Before you install Moin``Moin, make sure you have the necessary infra-structure in place, namely the ''Apache for Microsoft Windows'' webserver, and a ''Python'' installation (version 2.0 or higher is recommended, don't run 1.5.2 without a compelling reason).

In the following description, we assume that you have installed or will install things to these locations:
 * `C:\Apache` - the webserver
 * `C:\Python` - the Python interpreter
 * `C:\Moin` - Moin``Moin itself

Quite often, you might want to install things elsewhere, which is no problem at all; you just have to adapt any paths that appear in a command or config file to the locations you have chosen.

This installation procedure was tested with Apache 1.3.23 for Windows running on Windows/NT4SP6a, and using Python 2.0.

== Preparation ==

=== Installing Apache ===

You currently need an external webserver to run Moin``Moin, the recommended option is to use Apache if you haven't installed one on your machine already. To install Apache, consult the [http://httpd.apache.org/docs/windows.html Using Apache With Microsoft Windows] document. Make sure that your webserver runs without problems before you start to install Moin``Moin; problems with your webserver installation are not in the scope of this document.

=== Installing Python ===

Download [http://www.python.org/ftp/python/2.1.2/Python-2.1.2.exe Python 2.1.2] and install it. Python installation is done via a standard Windows installer program, which you should be familiar with.

=== Installing MoinMoin ===

Before creating a wiki instance, you have to download and install the basic Moin``Moin software. We assume you already have downloaded the distribution archive to the "`C:\TEMP`" directory[[FootNote(If you want to install the current development version from CVS, replace "C:\TEMP" with your "moin" working directory.)]].

Open a console window and enter the following commands:
{{{
C:
cd \temp
unzip moin-0.11.zip
cd moin-0.11
python setup.py install --prefix=C:\Moin --record=install.log
}}}

This will install all necessary files to the "`C:\Moin`" directory, and create a "`install.log`" file listing all the files that are created there.

[[FootNote]]

== Creating a Wiki Instance ==

You could run your wiki directly using the sample wiki created in "`C:\Moin`", but this is not recommended for two reasons:
 1. updating your wiki is more complicated and more dangerous.
 1. creating a second wiki instance, even if you currently don't plan for one, is much easier.

So, enter these commands in a console window:
{{{
cd \Moin
md mywiki
md mywiki\data
xcopy share\moin\data mywiki\data /E
copy share\moin\cgi-bin mywiki
}}}

"`mywiki`" is the name of your wiki instance, you might want to chose a different name best fitting the intended use of this instance; just don't name it simply "`wiki`", because that would result in problems later on.

Next, start your editor and create the file "`C:\Moin\mywiki\moin.bat`" with the following content (remember to change any paths that are different with your setup): {{{
@echo off
set PYTHONPATH=C:\Moin
C:
cd \Moin\mywiki
C:\Python\python.exe moin.cgi
}}}

 /!\ '''Python 2.2''': Python 2.2 changed the installation layout to better fit the UNIX scheme. Because of this, you have to change the command setting the `PYTHONPATH` to "{{{set PYTHONPATH=C:\Moin\Lib\site-packages}}}".

Then, append these lines to "`C:\Apache\conf\httpd.conf`": {{{
Alias /wiki/ "C:/Moin/share/moin/htdocs/"
ScriptAlias /mywiki "C:/Moin/mywiki/moin.bat"
}}}

The first line you only need once; the second line is needed once for each wiki instance (of course, each one with another wiki name and path).

That is all, '''restart your Apache server''' and try to access your new-born wiki with the URL "`http://127.0.0.1/mywiki/`". You should see the Front``Page, try to edit and save it, and if that works, see if your edit is reflected on the Recent``Changes page.

Finally, edit "`moin_config.py`" and at least change "`sitename`" and "`logo_url`" to some personal values:
{{{
sitename = 'My Wiki'
logo_url = '/images/mywiki-logo.gif'
}}}

For a personal or intranet installation, you'll normally also add the line {{{
allowed_actions = ['DeletePage', 'AttachFile']
}}}
