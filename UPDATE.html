<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta name="robots" content="noindex,nofollow">



<title>HelpOnUpdating - MoinMaster</title>
<link rel="stylesheet" type="text/css" charset="iso-8859-1" media="all" href="wiki/htdocs/classic/css/common.css">
<link rel="stylesheet" type="text/css" charset="iso-8859-1" media="all" href="wiki/htdocs/classic/css/print.css">


<link rel="Start" href="http://moinmaster.wikiwikiweb.de/FrontPage">
<link rel="Alternate" title="Wiki Markup" href="http://moinmaster.wikiwikiweb.de/HelpOnUpdating?action=raw">
<link rel="Alternate" media="print" title="Print View" href="http://moinmaster.wikiwikiweb.de/HelpOnUpdating?action=print">
<link rel="Search" href="http://moinmaster.wikiwikiweb.de/FindPage">
<link rel="Index" href="http://moinmaster.wikiwikiweb.de/TitleIndex">
<link rel="Glossary" href="http://moinmaster.wikiwikiweb.de/WordIndex">
<link rel="Help" href="http://moinmaster.wikiwikiweb.de/HelpOnFormatting">
</head>

<body lang="en" dir="ltr">
<div id="content" lang="en" dir="ltr">
<p>
<a href="http://moinmaster.wikiwikiweb.de/HelpContents">HelpContents</a> &gt; <a href="http://moinmaster.wikiwikiweb.de/HelpOnAdministration">HelpOnAdministration</a> &gt; HelpOnUpdating  
</p>
<p>
<strong>Index</strong> <ol>
<li>
<a href="#head-61e315ba11650973301814fad5511351f6f9b71a">General procedures</a></li>
<ol>
<li>
<a href="#head-dd96994d01e723dd6f9b0bdb6119722dbeb9faf0">Backup</a></li>
<li>
<a href="#head-fd6c3ebf7befca9f8208f86c76e4d4180303745c">Install</a></li>
<li>
<a href="#head-469fda7d0fe14908f18ceda7ecc812b3a18d650e">Configuration update</a></li>
<li>
<a href="#head-217754d96e10e6cb5c552a8afb72478768e880b9">Updating files</a></li>
<li>
<a href="#head-285ec850c11d78bac10f6bfa31b69a37f1b257c9">Troubleshooting</a></li>
</ol>

<li>
<a href="#head-978fb054168faa58843b80a58ab29a3abc33dc1e">Upgrade information for specfic versions</a></li>
<ol>
<li>
<a href="#head-d0b0f515ad64ca357140d4d452724c6892bbe084">Version 0.11</a></li>
<li>
<a href="#head-084e67410714ed45209c2fc1829d3b5161821488">Version 1.0</a></li>
<li>
<a href="#head-aebe0ed007174f53947b5cc077294c6b536f56d0">Version 1.1</a></li>
<li>
<a href="#head-b7238b18233914a27637a58322ad1e229a7760ee">Version 1.2</a></li>
</ol>

</ol>

 
</p>
<h3 id="head-61e315ba11650973301814fad5511351f6f9b71a">General procedures</h3>
<h4 id="head-dd96994d01e723dd6f9b0bdb6119722dbeb9faf0">Backup</h4>
<p>
<img src="wiki/htdocs/classic/img/alert.png" alt="/!\" height="15" width="15"> <strong>Before you update an existing wiki, MAKE A BACKUP!</strong> 
</p>
<p>
You have been warned, and it's not our fault when you end up like this: <img src="wiki/htdocs/classic/img/angry.png" alt="X-(" height="15" width="15">  
</p>
<p>
There are two directory trees which you should backup: 
</p>
                <ul>
                <li>
<p>
 The one containing the <a href="http://moinmaster.wikiwikiweb.de/MoinMoin">MoinMoin</a> executable files (e.g. <tt>/usr/lib/python*.*/site-packages/MoinMoin</tt>) 
</p>
</li>
                <li>
<p>
 and the one containing the data (e.g. <tt>/usr/share/moin/wikiname/data</tt> - see data_dir in your moin_config.py).  
</p>
</li>
                </ul>

<p>
The paths depend on your installation. 
</p>
<h4 id="head-fd6c3ebf7befca9f8208f86c76e4d4180303745c">Install</h4>
<p>
Download the <a href="http://moinmaster.wikiwikiweb.de/MoinMoin">MoinMoin</a> code that you are interested in updating to. 
</p>
<p>
As root, run "<tt>python&nbsp;setup.py&nbsp;install</tt>" to install the new version. 
</p>
<h4 id="head-469fda7d0fe14908f18ceda7ecc812b3a18d650e">Configuration update</h4>
<p>
After upgrading, your existing wiki should continue to work (the goal is to have sane defaults for any new config values, but then there can be bugs). Check that this is indeed the case, and then take the time to check the CHANGES file in your distribution. Often, new features will be invisible unless your extend your configuration in "moin_config.py". 
</p>
<p>
This is especially true for: 
</p>
    <ul>
    <li>
<p>
 somewhat dangerous macros that won't be activated by default, because they're not advisable for public wikis. You need to explicitely activate those by adding an <tt>allowed_actions</tt> list to the config. Currently, the actions <tt>DeletePage</tt> and <tt>AttachFile</tt> are considered unsafe. 
</p>
</li>
    <li class="gap">
<p>
 email features: you need to provide <tt>mail_smarthost</tt> and <tt>mail_from</tt>. 
</p>
</li>
    <li class="gap">
<p>
 new pages icons: to get new icons like "XML", "Subscribe" etc. it's best to just delete the <tt>page_icons</tt> setting, now that "config.py" has a default for it. If you changed it in the past, add new icons from the "config.py" default to your "moin_config.py". 
</p>
</li>
    </ul>

<h4 id="head-217754d96e10e6cb5c552a8afb72478768e880b9">Updating files</h4>
    <dl>
    <dt> Images</dt><dd>
<p>
On every update, you should copy the content of the "share/moin/htdocs/img" directory to the image directory visible to your web server, normally a new release has some new images in it. If you use the default distutils setup scheme, this is no longer necessary (distutils updates the files for you, and your webserver gets the files from the installed images). 
</p>
</dd>
    <dt> System pages</dt><dd>
<p>
When upgrading to a new version, copy at least the help pages ("Help*") to your existing directory. Then check whether you miss any new system pages.  
</p>
</dd>
    <dt> InterWiki</dt><dd>
<p>
Check that you have the newest "intermap.txt" file; If you have your own entries, you can point "shared_intermap" at a file loaded <em>before</em> the file in your data directory, which takes precedence (i.e. have global entries in the shared one, private entries the data dir file). 
</p>
</dd>
    </dl>
<h4 id="head-285ec850c11d78bac10f6bfa31b69a37f1b257c9">Troubleshooting</h4>
<p>
A good idea is to do a request for "moin.cgi?test" (which calls an internal diagnosis feature) after you installed a new release, which will spot some common errors. 
</p>
<p>
Depending on your installation, more tightly secured permissions are a good idea. Ideally, you assign all files in the data directory to the user the web server runs under, and then you use <tt>700</tt> or <tt>755</tt>. 
</p>
<h3 id="head-978fb054168faa58843b80a58ab29a3abc33dc1e">Upgrade information for specfic versions</h3>
<p>
The following sections provide information pertaining to specific versions of the software; if you jump several versions, read all the sections applying to your situation. 
</p>
<p>
<a id="update-0-11"> <h4 id="head-d0b0f515ad64ca357140d4d452724c6892bbe084">Version 0.11</h4>

</p>
<p>
<img src="wiki/htdocs/classic/img/idea.png" alt="(!)" height="15" width="15"> It is strongly recommended that you change any installation prior to 0.11 to the new distutils scheme, this will make any future upgrades much easier. 
</p>
<p>
You should follow the instructions on <a href="http://moinmaster.wikiwikiweb.de/HelpOnInstalling">HelpOnInstalling</a> regarding basic installation, until you come to the "Creating a wiki instance" step. Then you have two options: 
</p>
    <ol type="1">
    <li>
<p>
simply adapt your old instance to the new situation, this especially means to create an alias that points to the <tt>.../share/moin/htdocs</tt> directory; you have to change <tt>url_prefix</tt> to <tt>/wiki</tt> then. The positive effect is that you automatically get any new icons and CSS files of version 0.11 and any future version, because distutils will update them in that location. 
</p>
</li>
    <li>
<p>
create a new instance as per the instructions, copy the data directory from your old instance, and merge the configuration files. 
</p>
</li>
    </ol>

<p>
Check your configuration against the provided default <tt>moin_config.py</tt> that you find in <tt>.../share/moin/cgi-bin/moin_config.py</tt> after installation with distutils. You should add the <tt>sitename</tt> setting, which gets added to the page title, to RSS feeds and the like. 
</p>
<p>
When you are offically a part of the <a href="http://moinmaster.wikiwikiweb.de/InterWiki">InterWiki</a> system, then also add <tt>interwikiname</tt>, which should contain your own <a href="http://moinmaster.wikiwikiweb.de/InterWiki">InterWiki</a> moniker (for example "<tt>MoinMoin</tt>" for the <a href="http://moinmaster.wikiwikiweb.de/MoinMoin">MoinMoin</a> wiki itself). 
</p>
<p>
To get new icons, and also to allow I18N customization of the menu and icon links, you should either delete or adapt<sup><a href="#fndef-51a2d387e497c83f32ce7925d53b97adefa4877c-0" id="fnref-51a2d387e497c83f32ce7925d53b97adefa4877c-0">1</a></sup> your settings for <tt>page_icons</tt> and <tt>navi_bar</tt>. Note that the new <tt>navi_bar</tt> default setting gets the wiki's name from the new <tt>sitename</tt> setting, which previously was the main reason to have your own modified <tt>navi_bar</tt>. 
</p>
<p>
Due to I18N support for system pages, the only remaining configurable page name is that of the front page, which can be set by <tt>page_front_page</tt> (the old name <tt>front_page</tt> for that setting is also no longer supported); the reasoning behind this is that page name customization was mainly added and used for localization issues, while changing the front page name is rather common, often the front page is named like the whole wiki. 
</p>
<p>
Finally, copy any new system pages to your wiki data directory. The current system pages are in the directory <tt>.../share/moin/data/text</tt>. The minimal set to copy is the new help pages ("<tt>Help*</tt>"). If you are sure you have not modified any system pages, you can simply copy all of them to your instance <tt>data/text</tt> directory. 
</p>
<p>
<img src="wiki/htdocs/classic/img/alert.png" alt="/!\" height="15" width="15"> <strong>When copying all system pages with one command, be sure to delete pages from the following list of pages that are likely changed by your users.</strong> 
</p>
The following pages are very likely to change once a wiki is in use, and it is advisable to delete them from the master system page directory <tt>.../share/moin/data/text</tt> before any instance update; they are only included to seed new wikis: 
<pre>CategoryCategory
CategoryHomepage
FrontPage
HomepageTemplate
LocalSpellingWords
WikiHomePage
WikiName
WikiSandBox
</pre>The recommended set is in the following list: 
<pre>Help*
AbandonedPages
EventStats
EventStats_2fHitCounts
EventStats_2fUserAgents
FindPage
InterWiki
MoinMoin
OrphanedPages
PageSize
RandomPage
RecentChanges
SiteNavigation
StructuredText
SystemInfo
TitleIndex
UserPreferences
WantedPages
WikiWikiWeb
WordIndex
XsltVersion
</pre>If you want to do German visitors a favour, also copy the new German system and help pages, they will be automatically activated as long as you use the default <tt>page_icons</tt> and <tt>navi_bar</tt> settings: 
<pre>Hilfe*
AktuelleÄnderungen (Aktuelle_c4nderungen)
AufgegebeneSeiten
BenutzerEinstellungen
GesuchteSeiten
SeiteFinden
SeitenGröße (SeitenGr_f6_dfe)
StartSeite
TitelIndex
VerwaisteSeiten
WegWeiser
WortIndex
ZufallsSeite
</pre><p>
<div class="footnotes"><div></div><ul><li><span><a href="#fnref-51a2d387e497c83f32ce7925d53b97adefa4877c-0" id="fndef-51a2d387e497c83f32ce7925d53b97adefa4877c-0">1</a></span> Adapting means to compare your settings and the default values found in the MoinMoin/config.py file.</li></ul></div> 
</p>
<p>
<a id="update-1-0"> <h4 id="head-084e67410714ed45209c2fc1829d3b5161821488">Version 1.0</h4>

</p>
<p>
Version 1.0 is the last to support Python 1.5.2, but some optional features (like statistics) already require Python 2.0. 
</p>
<p>
<a id="update-1-1"> <h4 id="head-aebe0ed007174f53947b5cc077294c6b536f56d0">Version 1.1</h4>

</p>
<p>
Be sure to read the above section on <em>General procedures</em> before you start upgrading. 
</p>
<p>
<strong>Version 1.1 requires Python 2.0 or higher</strong>, we recommend to use Python 2.2 (version 2.2.2 if that is available on your host) or even better 2.3.2 (with 2.3.x, <a href="http://moinmaster.wikiwikiweb.de/MoinMoin">MoinMoin</a> runs about 20-30% faster). 
</p>
<p>
The next version (1.2) will require Python 2.2.2 or newer. 
</p>
<p>
<strong>Upgrading your configuration</strong> 
</p>
    <ul>
    <li>
<p>
 If you changed the default for <tt>page_template_ending</tt>, this is now called <tt>page_template_regex</tt> and must contain a regex (defaults to '[a-z]Template$'). 
</p>
</li>
    <li>
<p>
 Same applies to <tt>page_form_ending</tt> now called <tt>page_form_regex</tt> (default: '[a-z]Form$') 
</p>
</li>
    <li>
<p>
 Not a new feature, but configurable now: <tt>page_category_regex</tt> (default: '^Category[A-Z]') 
</p>
</li>
    <li>
<p>
 If you have added your own <tt>SecurityPolicy</tt>, the class interface for that has changed (see <tt>security.py</tt>). 
</p>
</li>
    </ul>

<p>
<strong>Enabling new features</strong> 
</p>
    <ul>
    <li>
<p>
 <tt>default_lang</tt> (default: 'en') - If user does not set a language in his user settings, this will be used. 
</p>
</li>
    <li>
<p>
 <tt>edit_locking</tt> (default: <tt>'warn&nbsp;10'</tt>) - Editor locking policy: None, 'warn &lt;timeout in minutes&gt;', or 'lock &lt;timeout in minutes&gt;'. 
</p>
</li>
    <li>
<p>
 <tt>hosts_deny</tt> (default: <tt>[]</tt>) - a list of denied IPs; if an IP ends with a dot, it denies a whole subnet (class A, B or C). 
</p>
</li>
    <li>
<p>
 <tt>html_pagetitle</tt> (default: <tt>None</tt>) -  Allows you to set a specific HTML page title (if not set, it defaults to the value of sitename). 
</p>
</li>
    <li>
<p>
 <tt>mail_login</tt> (default: <tt>None</tt>) - This is only needed when you use SMTP AUTH to send mail; in that case, set this to the username and password separated by a space, i.e. "user pwd". 
</p>
</li>
    <li>
<p>
 <tt>smileys</tt> (default: <tt>{}</tt>) -  User-defined smileys (a dict with the markup as the key and a tuple of width, height, border, image name as the value). 
</p>
</li>
    <li>
<p>
 don't forget to read the CHANGES file in the distribution archive 
</p>
</li>
    </ul>

<p>
<a id="update-1-2"> <h4 id="head-b7238b18233914a27637a58322ad1e229a7760ee">Version 1.2</h4>

</p>
<p>
<strong>Version 1.2 requires Python 2.2 or higher</strong>, we recommend to use Python &gt;=2.3.2 (with 2.3.x, <a href="http://moinmaster.wikiwikiweb.de/MoinMoin">MoinMoin</a> runs about 20-30% faster) or &gt;= 2.2.2. 
</p>
    <ul>
    <li>
<p>
 the URL for the <a href="http://moinmaster.wikiwikiweb.de/RecentChanges">RecentChanges</a> RSS feed changed. It now only works with <tt>?action=rss_rc</tt>. 
</p>
</li>
    <li class="gap">
<p>
 drawings use a new applet. It saves PNG instead of GIF and can do image maps to make areas of the drawing active. On display a GIF will be searched if no PNG is found. We recommend changing all GIFs to indexed PNGs cause this fallback might disappear in later versions.  Sample code using bash &amp; ImageMagick (be sure you know what you do):  
<pre>for draw in `find /path/to/wiki/data -name \*.draw`; do
    file=`dirname $draw`/`basename $draw .draw`
    if [ -e "${file}.gif" ]; then
        echo "Converting ${file}.gif to ${file}.png"
        convert "${file}.gif" "${file}.png"
    fi
done
</pre>
</p>
</li>
    <li class="gap">
<p>
 <tt>caching_formats</tt> (default: <tt>['text_html',]</tt>) - enable caching for the given output formats; enabled by default. Developers maybe want to disable this and use the empty list. 
</p>
</li>
    <li class="gap">
<p>
 Themeing and HTML/CSS cleanup 
</p>
</li>
        <ul>
        <li>
<p>
 Browsers with completely broken CSS support (like e.g. Netscape 4.x) are no longer supported. If you still need to support them, do not upgrade to moin 1.2. If you still use these browsers, we recommend that you upgrade your browser first (Mozilla 1.5 has nice and standards compliant HTML and CSS support and is available as Free Software for Windows, Linux and Mac). 
</p>
</li>
        <li>
<p>
 If you changed any html in code or by config you will have to check if it still works. For the usual stuff, look into <tt>MoinMoin/theme/classic.py</tt> and <tt>classic/css/screen.css</tt>. For config defaults of the html fragments, read <tt>MoinMoin/config.py</tt>. If you want to modify a theme, don't simply change classic, but copy or subclass it under a new theme name. 
</p>
</li>
        <li>
<p>
 because of the new theme support the layout of the <tt>htdocs</tt> directory changed: 
</p>
</li>
            <ul>
            <li>
<p>
 Instead of using icons under <tt>img/</tt> and css under <tt>css/</tt>, there will be an additional <tt>themename/</tt> directory in between, e.g. <tt>classic/img/</tt> and <tt>classic/css/</tt>. If you added own icons, you may have to copy them to the themes directory. 
</p>
</li>
            <li>
<p>
 The filename of the CSS file has changed to the media type, so the normal one used for screen output has changed name from <tt>moinmoin.css</tt> to <tt>screen.css</tt>. There also were quite some changes and enhancements to the CSS files, so better use the new ones. 
</p>
</li>
            </ul>

        <li>
<p>
 config.css_url was removed 
</p>
</li>
        </ul>

    <li class="gap">
<p>
 Plugins - we use a new plugin loader that requires a correct <tt>__init__.py</tt> file in the plugin directories. See the directory <tt>wiki/data/plugin/</tt> in the distribution archive and just copy it over to your wiki's plugin directory. 
</p>
</li>
    <li class="gap">
<p>
 Do not forget to update to the new Twikidrawplugin that comes with moin 1.2. 
</p>
</li>
    <li class="gap">
<p>
 removed config variables: 
</p>
</li>
        <ul>
        <li>
<p>
 external_diff (not needed any more, we have internal diff now) 
</p>
</li>
        <li>
<p>
 shared_metadb (wasn't implemented for long - we will re-add it, when it is) 
</p>
</li>
        <li>
<p>
 title1/2 (please use page_header1/2) 
</p>
</li>
        <li>
<p>
 page_icons_up 
</p>
</li>
        </ul>

    <li class="gap">
<p>
 changed config variables: 
</p>
</li>
        <ul>
        <li>
<p>
 changed_time_fmt (removed some html and brackets around time from default) 
</p>
</li>
        <li>
<p>
 html_head (default is empty string now) 
</p>
</li>
        <li>
<p>
 page_footer1/2 (default is empty string now) 
</p>
</li>
        <li>
<p>
 page_icons (is now a list of icon names, not html any more) 
</p>
</li>
        <li>
<p>
 umask (default is 0770 now, not world r/w any more == more secure) 
</p>
</li>
        </ul>

    <li class="gap">
<p>
 new config variables (see <a class="interwiki" title="MoinMaster" href="http://moinmaster.wikiwikiweb.de/HelpOnConfiguration"><img src="wiki/htdocs/classic/img/moin-inter.png" alt="[MoinMaster]" height="16" width="16">HelpOnConfiguration</a>): 
</p>
</li>
        <ul>
        <li>
<p>
 cookie_lifetime 
</p>
</li>
        <li>
<p>
 mail_login 
</p>
</li>
        <li>
<p>
 page_credits 
</p>
</li>
        <li>
<p>
 page_dict_regex 
</p>
</li>
        <li>
<p>
 page_group_regex 
</p>
</li>
        <li>
<p>
 page_header1/2 
</p>
</li>
        <li>
<p>
 page_iconbar  
</p>
</li>
        <li>
<p>
 page_icons_table 
</p>
</li>
        <li>
<p>
 page_license_enabled 
</p>
</li>
        <li>
<p>
 page_license_page 
</p>
</li>
        <li>
<p>
 theme_default 
</p>
</li>
        <li>
<p>
 theme_force 
</p>
</li>
        <li>
<p>
 tz_offset  
</p>
</li>
</ul>

</ul>

</div>
</body>
</html>

